%w(rip_dbnl test/unit).each { |l| require l }

module DNBL::Tests
  def setup
    parser = Parser.new 'http://www.dbnl.org/tekst/wolf016corn01_01/'
    @wolf = @parser.create_book
    parser = Parser.new 'http://www.dbnl.org/tekst/anth004belg01_01/'
    @anthierens = @parser.create_book
  end

  def test_book_details
    assert_equal @wolf.title, "Historie van mejuffrouw Cornelia Wildschut. Deel 1"
    assert_equal @wolf.author, "Betje Wolff en Aagje Deken"
    assert_equal @anthierens.title = "Het Belgische domdenken"
    assert_equal @anthierens.author = "Johan Anthierens"
  end

  def test_chapter_list
    chapters = @wolf.chapters
    assert_equal chapters[0].title, "Voorrede."
    assert_equal chapters[-1].title, "Een- en veertigste brief. Juffrouw cornelia wildschut, aan Juffrouw anna hofman."
    chapters = @anthierens.chapters
    assert_equal chapters[0].title, "De opgezette Belg Biologieles"
    assert_equal chapters[-1].title, "En eeuwig bloeien de begonia's... Naschrift"
  end

  def test_pages
    chapter = @wolf.chapters.first
    assert_equal chapter.pages[4].paragraphs.first, "lijker zijn? hierin ligt zeer zeker de oorzaak dat veelen wier oogmerk beter is dan hun doorzicht of oordeel, alles wat den naam draagt van Roman ongelezen veroordeelen, als behoorende tot het legio der nutlooze of schadelijke boeken, die ons, uit verscheidene oorden, met geheele baalen worden toegezonden."
    chapter = @anthierens.chapters.first
    assert_equal chapter.pages[1].paragraphs.first, "'Kijk uw Belg goed in de ogen en prent uzelf de kleur ervan in het geheugen, zodat u straks, wanneer de echte kleuren zijn verbleekt, de juiste kunstogen kunt kiezen. Om beschadiging te voorkomen doodt u zonodig de Belg onder een kaasstolp met gas. Stop alle lichaamsopeningen dicht met watten en laat het lichaam in de zon drogen. Eenmaal droog opent u de Belg via een snede midden over de borst. Knip de opperarm los met een nijptang en stroop de huid af. Spieren verwijdert u met een mesje; de hersenen lepelt u uit het achterhoofdsgat. Rol de huid, onder kwistig gebruik van conserveringsmiddelen, terug en vul hem op met behulp van ijzerdraad, watten en houtwol. Geef tot slot de Belg zijn houding; op een (schommelend) stokje schijnt het leukst te zijn.'"
  end
end
